{% extends 'base.html.twig' %}

{% block titre %}
    {{ parent() }} - 
    {% if myself is defined %}
        {{ myself }}
    {% else %}
        {{user.user_identifier}} Profile Page
    {% endif %}
{% endblock %}

{% block stylesheets %}
	{{ parent() }}
{% endblock %}

{% block javascripts %}
    {{ parent() }}  
    <style>
        input[type="file"] {
            display: none;
        }
    </style>
{% endblock %}

{% block body %}
    {% include 'navbar.html.twig' %}
    <main>
        <div class="container mt-4">
            <!--{{ dump(user) }}-->
            <div class="d-flex justify-content-center align-items-center rounded-circle overflow-hidden shadow-lg bg-light" style="width: 100px; height: 100px;">
                <img class="img-fluid w-100 h-100 object-fit-cover" 
                {% if user.avatar == null %}
                    src="{{ asset("images/default.png") }}"
                {% else %}
                    src="{{ user.avatar }}"
                {% endif %}
                >
            </div>    
            <span class= "row ps-2">
                {{user.username}}
                {% if myself is defined %}
                    <form class="col" methode="POST" enctype="multipart/form-data">
                        <button type="submit" class="btn btn-primary"
                            onclick="document.getElementById('fileInput').click();"
                            style="--bs-btn-padding-y: .25rem; --bs-btn-padding-x: .5rem; --bs-btn-font-size: .75rem;">
                            Modifier
                        </button>
                        <input type="file" id="fileInput" style="display:none;" onchange="displayFileName(this)" accept=".png, .jpg, .jpeg">
                    </form>
                {% elseif acctualuser is defined and "ROLE_ADMIN" in acctualuser.roles and "ROLE_ADMIN" not in user.roles %}
                    <span class="col">
                        {% if user.ban == false %}
                            <button type="button" class="btn btn-danger"
                                style="--bs-btn-padding-y: .25rem; --bs-btn-padding-x: .5rem; --bs-btn-font-size: .75rem;">
                                Bannir
                            </button>
                        {% else %}
                            <button type="button" class="btn btn-danger"
                                style="--bs-btn-padding-y: .25rem; --bs-btn-padding-x: .5rem; --bs-btn-font-size: .75rem;">
                                Debannir
                            </button>
                        {% endif %}
                    </span>
                {% endif %}
            </span>
        </div>
        <br>
        {% for post in user.posts %}
            <article>
                <img src="{{post.image}}"></img><br>
                <span>{{post.description}}</span>
                <br><br>
            </article>
            <div>
                Commentaires:<br>
                <br>
                {% for comment in post.commentaires %}
                    De: {{comment.user_id.username}}<br>
                    {{comment.content}}
                {% endfor %}
            </div>
        {% endfor %}
    </main>
{% endblock %}